# Issue Tracker CLI å·¥å…· - æŠ€æœ¯è®¾è®¡æ–¹æ¡ˆ

> **ç‰ˆæœ¬**: 2.0
> **æ—¥æœŸ**: 2026-02-04
> **ä½œè€…**: Claude Code
> **å®šä½**: å¤šé¡¹ç›®é€šç”¨å¼€å‘å·¥å…·ï¼Œæ”¯æŒç‹¬ç«‹é…ç½®å’Œæ•°æ®å­˜å‚¨

---

## 1. æ¦‚è¿°

### 1.1 èƒŒæ™¯

Issue Tracker CLI æ˜¯ä¸€ä¸ªé€šç”¨çš„ Issue è¿½è¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒå¤šé¡¹ç›®ç‹¬ç«‹è¿è¡Œã€‚é€šè¿‡ `-p project_id` åˆ‡æ¢é¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®æ‹¥æœ‰ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶å’Œæ•°æ®åº“ï¼Œæ•°æ®å®Œå…¨éš”ç¦»ã€‚

### 1.2 æ ¸å¿ƒè®¾è®¡ç›®æ ‡

| ç›®æ ‡ | è¯´æ˜ |
|------|------|
| **å¤šé¡¹ç›®æ”¯æŒ** | é€šè¿‡ project_id åˆ‡æ¢ï¼Œé…ç½®å’Œæ•°æ®åº“ç‹¬ç«‹å­˜å‚¨ |
| **ç¼–å·è‡ªåŠ¨åˆ†é…** | å…¨å±€è‡ªåŠ¨é€’å¢åºå·ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç† |
| **é›¶ä¾èµ–** | ä»…ä¾èµ– Python æ ‡å‡†åº“ + PyYAML |
| **åŒå‘åŒæ­¥** | MD â†’ DB (migrate) + DB â†’ MD (export) |
| **CLI å‹å¥½** | æ”¯æŒè„šæœ¬è°ƒç”¨ + ç›´æ¥ `sqlite3` å‘½ä»¤è¡Œè®¿é—® |
| **GitHub é›†æˆ** | è‡ªåŠ¨å…³é—­å·²ä¿®å¤é—®é¢˜çš„ GitHub Issue |

### 1.3 æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Python 3.10+
- **æ•°æ®åº“**: SQLite3 (å†…ç½®)
- **é…ç½®**: YAML (PyYAML)
- **æµ‹è¯•**: unittest (å†…ç½®)
- **å¤–éƒ¨ä¾èµ–**: `gh` CLI (GitHub åŒæ­¥åŠŸèƒ½)

---

## 2. ç³»ç»Ÿæ¶æ„

### 2.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ISSUE_TRACKER_HOME                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        .config/                                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ 001_WeldSmart    â”‚  â”‚ 002_Another      â”‚  â”‚ 003_Project   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    .yaml         â”‚  â”‚    .yaml         â”‚  â”‚    .yaml      â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                           data/                                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ 001_WeldSmart    â”‚  â”‚ 002_Another      â”‚  â”‚ 003_Project   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    _Pro.db       â”‚  â”‚    _Project.db   â”‚  â”‚    .db        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Issue Tracker CLI                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     cli.py (å…¥å£å±‚)                               â”‚  â”‚
â”‚  â”‚  -p <project_id>  â†’  æŸ¥æ‰¾ .config/{project_id}_*.yaml              â”‚  â”‚
â”‚  â”‚  -c <config>      â†’  æ‰‹åŠ¨æŒ‡å®šé…ç½®æ–‡ä»¶                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                               â”‚                                   â”‚  â”‚
â”‚  â–¼                               â–¼                                   â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Config Loader   â”‚   â”‚           Core Modules                  â”‚  â”‚
â”‚  â”‚   config.yaml     â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚                   â”‚   â”‚  â”‚ Database â”‚  â”‚     Exporter        â”‚  â”‚  â”‚
â”‚  â”‚  - project.id     â”‚   â”‚  â”‚   (CRUD) â”‚  â”‚  (MD ç”Ÿæˆ)          â”‚  â”‚  â”‚
â”‚  â”‚  - id_rules.formatâ”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  - priorities     â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  - statuses       â”‚   â”‚  â”‚  Github  â”‚  â”‚      Model          â”‚  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚   Sync   â”‚  â”‚   (Issue dataclass) â”‚  â”‚  â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚  Migrator æ’ä»¶    â”‚                                                   â”‚
â”‚  â”‚                   â”‚                                                   â”‚
â”‚  â”‚  BaseMigrator     â”‚â—„â”€â”€â”€â”€â”€â”€ é¡¹ç›®ç‰¹å®šå®ç°                              â”‚
â”‚  â”‚    (æŠ½è±¡åŸºç±»)     â”‚                                                   â”‚
â”‚  â”‚                   â”‚                                                   â”‚
â”‚  â”‚  WeldSmart        â”‚                                                   â”‚
â”‚  â”‚  Migrator         â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 é…ç½®æ–‡ä»¶æŸ¥æ‰¾é€»è¾‘

```
ç”¨æˆ·å‘½ä»¤: issue-tracker -p 001 stats
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é…ç½®æŸ¥æ‰¾ä¼˜å…ˆçº§:                                              â”‚
â”‚                                                             â”‚
â”‚  1. -p <project_id>      â†’ æœç´¢ .config/{project_id}_*.yaml  â”‚
â”‚  2. -c <config>          â†’ ç›´æ¥ä½¿ç”¨æŒ‡å®šè·¯å¾„                   â”‚
â”‚  3. (æ— å‚æ•°)             â†’ ä¾æ¬¡æŸ¥æ‰¾:                         â”‚
â”‚     a) å½“å‰ç›®å½•/config.yaml                                    â”‚
â”‚     b) .config/ å”¯ä¸€é…ç½®æ–‡ä»¶                                   â”‚
â”‚     c) git root/config.yaml                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 æ¨¡å—èŒè´£

| æ¨¡å— | æ–‡ä»¶ | èŒè´£ |
|------|------|------|
| **CLI å…¥å£** | `cli.py` | å‚æ•°è§£æã€é¡¹ç›®åˆ‡æ¢ã€å‘½ä»¤åˆ†å‘ã€é”™è¯¯å¤„ç† |
| **é…ç½®ç®¡ç†** | `core/config.py` | åŠ è½½æ ¡éªŒã€ä¼˜å…ˆçº§/çŠ¶æ€æšä¸¾æ ¡éªŒ |
| **æ•°æ®è®¿é—®** | `core/database.py` | SQLite CRUDã€æŸ¥è¯¢è¿‡æ»¤ã€ç»Ÿè®¡èšåˆ |
| **æ•°æ®æ¨¡å‹** | `core/model.py` | Issue æ•°æ®ç±»å®šä¹‰ |
| **å¯¼å‡ºå™¨** | `core/exporter.py` | DB â†’ Markdown è½¬æ¢ |
| **GitHub åŒæ­¥** | `core/github_sync.py` | è°ƒç”¨ gh CLIã€è®°å½•åŒæ­¥æ—¥å¿— |
| **è¿ç§»æ’ä»¶** | `migrators/*.py` | æºæ–‡ä»¶è§£æï¼ˆé¡¹ç›®ç‰¹å®šï¼‰ |

---

## 3. æ•°æ®æ¨¡å‹è®¾è®¡

### 3.1 æ•°æ®åº“ Schema

```sql
-- æ ¸å¿ƒé—®é¢˜è¡¨
CREATE TABLE IF NOT EXISTS issues (
    id              TEXT    PRIMARY KEY,       -- é—®é¢˜ç¼–å· (çº¯æ•°å­—å¦‚ 001, 002)
    title           TEXT    NOT NULL,          -- æ ‡é¢˜
    priority        TEXT    NOT NULL,          -- ä¼˜å…ˆçº§ (P0/P1/P2/P3)
    status          TEXT    NOT NULL DEFAULT 'pending',  -- çŠ¶æ€
    discovery_date  TEXT    NOT NULL,          -- å‘ç°æ—¥æœŸ YYYY-MM-DD
    fix_date        TEXT,                       -- ä¿®å¤æ—¥æœŸ YYYY-MM-DD
    file_path       TEXT,                       -- æ–‡ä»¶è·¯å¾„ (é€—å·åˆ†éš”)
    location        TEXT,                       -- ä½ç½®æè¿°
    description     TEXT,                       -- é—®é¢˜æè¿°
    impact          TEXT,                       -- å½±å“
    fix_plan        TEXT,                       -- ä¿®å¤æ–¹æ¡ˆ
    estimated_hours REAL,                       -- é¢„è®¡å·¥æ—¶
    actual_hours    REAL,                       -- å®é™…å·¥æ—¶
    phase           TEXT,                       -- æ‰€å±é˜¶æ®µ
    github_issue_id INTEGER,                   -- GitHub Issue ç¼–å·
    created_at      TEXT    DEFAULT (datetime('now')),
    updated_at      TEXT    DEFAULT (datetime('now'))
);

-- GitHub åŒæ­¥æ—¥å¿—è¡¨
CREATE TABLE IF NOT EXISTS github_sync_log (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    issue_id        TEXT    NOT NULL,
    github_issue_id INTEGER NOT NULL,
    action          TEXT    NOT NULL,          -- close / comment
    status          TEXT    NOT NULL,          -- success / failed
    error_msg       TEXT,
    synced_at       TEXT    DEFAULT (datetime('now')),
    FOREIGN KEY (issue_id) REFERENCES issues(id)
);

-- ç´¢å¼•
CREATE INDEX idx_priority        ON issues(priority);
CREATE INDEX idx_status          ON issues(status);
CREATE INDEX idx_discovery_date  ON issues(discovery_date);
CREATE INDEX idx_github          ON issues(github_issue_id);

-- è§†å›¾ï¼šå¾…å¤„ç†é—®é¢˜
CREATE VIEW v_pending AS
    SELECT id, title, priority, status, discovery_date, file_path
    FROM issues
    WHERE status IN ('pending', 'in_progress', 'planned')
    ORDER BY priority, discovery_date;

-- è§†å›¾ï¼šæ¦‚è¦æ±‡æ€»
CREATE VIEW v_summary AS
    SELECT id, title, priority, status, discovery_date, fix_date, github_issue_id
    FROM issues
    ORDER BY id;
```

### 3.2 Issue æ•°æ®ç±»

```python
@dataclass
class Issue:
    """é—®é¢˜æ¡ç›®æ•°æ®ç±»."""
    id: str                      # é—®é¢˜ç¼–å· (çº¯æ•°å­—: 001, 002...)
    title: str                   # æ ‡é¢˜
    priority: str                # ä¼˜å…ˆçº§
    status: str                  # çŠ¶æ€
    discovery_date: str          # å‘ç°æ—¥æœŸ
    fix_date: str | None = None  # ä¿®å¤æ—¥æœŸ
    file_path: str | None = None # æ–‡ä»¶è·¯å¾„
    location: str | None = None  # ä½ç½®
    description: str | None = None   # æè¿°
    impact: str | None = None        # å½±å“
    fix_plan: str | None = None      # ä¿®å¤æ–¹æ¡ˆ
    estimated_hours: float | None = None  # é¢„è®¡å·¥æ—¶
    actual_hours: float | None = None     # å®é™…å·¥æ—¶
    phase: str | None = None              # é˜¶æ®µ
    github_issue_id: int | None = None    # GitHub Issue ç¼–å·
```

### 3.3 çŠ¶æ€æšä¸¾

| çŠ¶æ€å€¼ | ç¬¦å· | å«ä¹‰ |
|--------|------|------|
| `fixed` | âœ… | å·²ä¿®å¤/å·²å®Œæˆ |
| `pending` | âŒ | å¾…ä¿®å¤ |
| `in_progress` | ğŸŸ¢ | è¿›è¡Œä¸­ |
| `planned` | ğŸ“‹ | å¾…è§„åˆ’ |
| `n_a` | âš ï¸ | ä¸é€‚ç”¨ |

### 3.4 ç¼–å·è§„åˆ™

**å…¨å±€è‡ªåŠ¨é€’å¢åºå·**: ç¼–å·ä¸ºçº¯æ•°å­—ï¼ˆ001, 002, 003...ï¼‰ï¼Œç”±å·¥å…·è‡ªåŠ¨åˆ†é…ã€‚

| æ“ä½œ | ç¼–å·åˆ†é…æ–¹å¼ |
|------|-------------|
| **æ–°å¢** | è‡ªåŠ¨åˆ†é…ä¸‹ä¸€ä¸ªåºå· |
| **æ›´æ–°** | ä¿æŒåŸç¼–å·ä¸å˜ |
| **è¿ç§»** | æŒ‰å‘ç°æ—¥æœŸæ’åºåè‡ªåŠ¨é‡åˆ†é… |

---

## 4. æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 4.1 é…ç½®ç®¡ç† (Config)

**èŒè´£**:
- åŠ è½½å¹¶æ ¡éªŒ `config.yaml`
- ç¼–å·æ ¼å¼éªŒè¯
- ä¼˜å…ˆçº§/çŠ¶æ€æšä¸¾æ ¡éªŒ

**å…³é”®æ–¹æ³•**:
```python
class Config:
    def __init__(self, config_path: str)
    def is_valid_id(self, issue_id: str) -> bool      # æ ¡éªŒçº¯æ•°å­—
    def is_valid_priority(self, priority: str) -> bool
    def is_valid_status(self, status: str) -> bool
```

**é…ç½®ç»“æ„**:
```yaml
project:
  id: "001"                      # é¡¹ç›®ç¼–å·ï¼ˆçº¯æ•°å­—ï¼‰
  name: "Project Name"

id_rules:
  format: "{num:03d}"            # ç¼–å·æ ¼å¼

priorities: [P0, P1, P2, P3]     # ä¼˜å…ˆçº§åˆ—è¡¨
statuses: [pending, in_progress, planned, fixed, n_a]  # çŠ¶æ€åˆ—è¡¨

github:
  enabled: true
  close_on_fix: true
  comment_template: "è‡ªåŠ¨åŒæ­¥: {issue_id} å·²ä¿®å¤"

export:
  output: "exports/issues.md"    # ç›¸å¯¹äº ISSUE_TRACKER_HOME
```

### 4.2 æ•°æ®è®¿é—®å±‚ (Database)

**èŒè´£**:
- SQLite è¿æ¥ç®¡ç†
- CRUD æ“ä½œå°è£…
- å¤šæ¡ä»¶æŸ¥è¯¢æ„å»º
- ç»Ÿè®¡èšåˆ

**å…³é”®æ–¹æ³•**:
```python
class Database:
    def add_issue(self, issue: Issue) -> None
    def get_issue(self, issue_id: str) -> Issue | None
    def update_issue(self, issue_id: str, **fields) -> bool
    def delete_issue(self, issue_id: str) -> bool
    def issue_exists(self, issue_id: str) -> bool
    def get_next_id(self) -> int  # è¿”å›ä¸‹ä¸€ä¸ªå¯ç”¨åºå·

    def query_issues(
        self, issue_id: str | None = None,
        priority: str | None = None,
        status: str | None = None,
        phase: str | None = None,
        file_glob: str | None = None,
        github_issue_id: int | None = None,
    ) -> list[Issue]

    def get_stats(self) -> dict
    def get_pending_github_sync(self) -> list[Issue]
    def log_github_sync(self, issue_id: str, gh_id: int,
                       action: str, status: str, error: str | None = None) -> None
```

### 4.3 å¯¼å‡ºå™¨ (Exporter)

**èŒè´£**:
- ä»æ•°æ®åº“ç”Ÿæˆ Markdown æ–‡æ¡£
- ç»Ÿè®¡æ±‡æ€»è¡¨ç”Ÿæˆ

**è¾“å‡ºç»“æ„**:
```markdown
# Project é—®é¢˜æ¸…å•æ±‡æ€»

> ç”Ÿæˆæ—¶é—´: YYYY-MM-DD HH:MM
> æ€»æ¡ç›®æ•°: N | å·²ä¿®å¤: X | å¾…å¤„ç†: Y

## ç›®å½•
...

## æ–‡æ¡£æ ¼å¼è§„èŒƒ
...

## æ€»ä½“ç»Ÿè®¡
### æŒ‰ä¼˜å…ˆçº§ç»Ÿè®¡
### é—®é¢˜æ¦‚è¦æ±‡æ€»

## Critical Priority (P0)
### 001: æ ‡é¢˜ - âœ… å·²ä¿®å¤
...

## å¾…ä¿®å¤é—®é¢˜ä¼˜å…ˆçº§æ’åº
...

## é™„å½•ï¼šé—®é¢˜åˆ†ç±»ç»Ÿè®¡
...
```

### 4.4 GitHub åŒæ­¥ (GithubSync)

**èŒè´£**:
- å•å‘åŒæ­¥: `status=fixed` â†’ å…³é—­ GitHub Issue
- è°ƒç”¨ `gh issue close` CLI å‘½ä»¤
- è®°å½•åŒæ­¥æ—¥å¿—ï¼ˆé¿å…é‡å¤åŒæ­¥ï¼‰

**åŒæ­¥æ¡ä»¶**:
```sql
SELECT * FROM issues
WHERE status = 'fixed'
  AND github_issue_id IS NOT NULL
  AND id NOT IN (
    SELECT issue_id FROM github_sync_log
    WHERE action = 'close' AND status = 'success'
  )
```

**å‘½ä»¤æ ¼å¼**:
```bash
gh issue close <github_issue_id> --comment "è‡ªåŠ¨åŒæ­¥: {issue_id} å·²ä¿®å¤"
```

### 4.5 è¿ç§»æ’ä»¶ (Migrator)

**åŸºç±»æ¥å£**:
```python
class BaseMigrator(ABC):
    @abstractmethod
    def parse(self, source_path: str) -> list[dict]:
        """è§£ææºæ–‡ä»¶ï¼Œè¿”å› issue å­—å…¸åˆ—è¡¨."""
        raise NotImplementedError

    def validate(self, issues: list[dict]) -> list[str]:
        """æ•°æ®å®Œæ•´æ€§æ ¡éªŒï¼Œè¿”å›è­¦å‘Šä¿¡æ¯åˆ—è¡¨."""
        ...
```

**WeldSmartMigrator å®ç°**:

è§£æ `all-issues.md` çš„ç‰¹å®šæ ¼å¼:
- æ ‡é¢˜è¡Œ: `### C-001: æ ‡é¢˜ - âœ… å·²ä¿®å¤/å·²å®Œæˆ`
- å•è¡Œå­—æ®µ: `**å‘ç°æ—¥æœŸ**: YYYY-MM-DD`
- å¤šè¡Œå­—æ®µ: `**é—®é¢˜æè¿°**:` åç»­è¡Œç´¯ç§¯

**çŠ¶æ€ç¬¦å·æ˜ å°„**:
```python
STATUS_SYMBOL_MAP = {
    "âœ…": "fixed",      # å·²ä¿®å¤/å·²å®Œæˆ
    "âŒ": "pending",    # å¾…ä¿®å¤
    "âš ï¸": "n_a",        # ä¸é€‚ç”¨
    "ğŸŸ¢": "in_progress", # è¿›è¡Œä¸­
    "ğŸ“‹": "planned",    # å¾…è§„åˆ’
}
```

---

## 5. CLI å‘½ä»¤è®¾è®¡

### 5.1 å‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | åŠŸèƒ½ | å…³é”®å‚æ•° |
|------|------|---------|
| `add` | æ–°å¢é—®é¢˜ | `--title`, `--priority`, `--id` |
| `update` | æ›´æ–°å­—æ®µ | `--status`, `--fix-date`, `--actual-hours` |
| `query` | å¤šæ¡ä»¶æŸ¥è¯¢ | `--priority`, `--status`, `--file`, `--detail` |
| `list` | ç®€æ´åˆ—è¡¨ | `--status`, `--priority` |
| `stats` | ç»Ÿè®¡æ¦‚è§ˆ | æ—  |
| `export` | ç”Ÿæˆ MD | `--output` |
| `sync` | GitHub åŒæ­¥ | `--dry-run` |
| `migrate` | å¯¼å…¥æ•°æ® | `--source`, `--migrator`, `--force` |

### 5.2 é¡¹ç›®åˆ‡æ¢

```bash
# é€šè¿‡ project_id åˆ‡æ¢
issue-tracker -p 001 stats
issue-tracker -p 002 query --status pending

# æ‰‹åŠ¨æŒ‡å®šé…ç½®æ–‡ä»¶
issue-tracker -c /path/to/config.yaml query
```

### 5.3 ç”¨æ³•ç¤ºä¾‹

```bash
# æ–°å¢é—®é¢˜ï¼ˆç¼–å·è‡ªåŠ¨åˆ†é…ï¼‰
issue-tracker -p 001 add \
    --title "ç¤ºä¾‹é—®é¢˜" \
    --priority P2 \
    --file "src/test.cpp"

# æ›´æ–°çŠ¶æ€
issue-tracker -p 001 update 001 --status fixed --fix-date 2026-02-04

# æŸ¥è¯¢
issue-tracker -p 001 query --priority P2 --status pending --detail

# ç»Ÿè®¡
issue-tracker -p 001 stats

# å¯¼å‡º
issue-tracker -p 001 export

# GitHub åŒæ­¥é¢„è§ˆ
issue-tracker -p 001 sync --dry-run

# è¿ç§»å¯¼å…¥ï¼ˆç¼–å·è‡ªåŠ¨é‡åˆ†é…ï¼‰
issue-tracker -p 001 migrate \
    --source all-issues.md \
    --migrator weldsmart
```

---

## 6. é€šç”¨åŒ–è®¾è®¡

### 6.1 é€šç”¨ vs é¡¹ç›®ç‰¹å®š

| ç»„æˆéƒ¨åˆ† | æ˜¯å¦é€šç”¨ | å¤„ç†æ–¹å¼ |
|---------|---------|---------|
| æ ¸å¿ƒè¡¨ç»“æ„ | âœ… é€šç”¨ | ç›´æ¥ç”¨ |
| CLI å‘½ä»¤é›† | âœ… é€šç”¨ | ç›´æ¥ç”¨ |
| GitHub åŒæ­¥é€»è¾‘ | âœ… é€šç”¨ | ç›´æ¥ç”¨ |
| é¡¹ç›®ç¼–å· | âŒ é¡¹ç›®ç‰¹å®š | é…ç½®æ–‡ä»¶ |
| ä¼˜å…ˆçº§æšä¸¾ | âŒ é¡¹ç›®ç‰¹å®š | é…ç½®æ–‡ä»¶ |
| çŠ¶æ€æšä¸¾ | âŒ é¡¹ç›®ç‰¹å®š | é…ç½®æ–‡ä»¶ |
| è¿ç§»è„šæœ¬ | âŒ é¡¹ç›®ç‰¹å®š | migrator æ’ä»¶ |
| Export æ ¼å¼ | âŒ é¡¹ç›®ç‰¹å®š | å‚æ•°åŒ– |

### 6.2 æ–°é¡¹ç›®æ¥å…¥æ­¥éª¤

1. **åˆ›å»ºé…ç½®æ–‡ä»¶**: åœ¨ `ISSUE_TRACKER_HOME/.config/` åˆ›å»º `{project_id}_{name}.yaml`
2. **é…ç½®é¡¹ç›®å‚æ•°**: ä¿®æ”¹ `project.id`, `project.name`, `priorities`, `statuses`
3. **å®ç° Migrator æ’ä»¶**: ç»§æ‰¿ `BaseMigrator` è§£æé¡¹ç›®ç‰¹å®šæ ¼å¼
4. **éªŒè¯**: `issue-tracker -p {project_id} migrate --dry-run`

---

## 7. æ•°æ®æµä¸åŒæ­¥ç­–ç•¥

### 7.1 MD â†” DB åŒå‘åŒæ­¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ISSUE_TRACKER_HOME                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ exports/        â”‚         â”‚ data/                â”‚  â”‚
â”‚  â”‚ issues.md       â”‚         â”‚ {project_id}_*.db    â”‚  â”‚
â”‚  â”‚ (Git æŒä¹…åŒ–)    â”‚         â”‚ (æœ¬åœ°å·¥ä½œç¯å¢ƒ)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â–²                            â–²                 â”‚
â”‚         â”‚                            â”‚                 â”‚
â”‚         â”‚ export                    â”‚ migrate          â”‚
â”‚         â”‚                            â”‚                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”            â”‚
â”‚    â”‚         Issue Tracker CLI          â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 GitHub å•å‘åŒæ­¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     status=fixed      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ¬åœ° DB    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚ GitHub Issueâ”‚
â”‚  (issues.db)â”‚   gh issue close     â”‚    (è¿œç¨‹)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                    â”‚
       â”‚ è®°å½•åŒæ­¥æ—¥å¿—                        â”‚ å·²å…³é—­
       â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ github_sync_log â”‚              â”‚   Closed    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. æµ‹è¯•ç­–ç•¥

### 8.1 å•å…ƒæµ‹è¯•è¦†ç›–

| æµ‹è¯•ç±» | è¦†ç›–èŒƒå›´ | ç”¨ä¾‹æ•° |
|--------|---------|--------|
| `TestConfig` | é…ç½®åŠ è½½æ ¡éªŒ | 5 |
| `TestDatabaseCRUD` | æ•°æ®åº“å¢åˆ æ”¹æŸ¥ | 10 |
| `TestDatabaseQuery` | æŸ¥è¯¢è¿‡æ»¤ | 6 |
| `TestDatabaseStats` | ç»Ÿè®¡èšåˆ | 3 |
| `TestWeldSmartMigrator` | MD è§£æ | 7 |
| `TestExporter` | Markdown ç”Ÿæˆ | 4 |
| `TestGithubSync` | GitHub åŒæ­¥ (mock) | 6 |
| `TestGithubSyncQuery` | åŒæ­¥æŸ¥è¯¢æ¡ä»¶ | 4 |
| **æ€»è®¡** | | **45** |

### 8.2 è¿è¡Œæµ‹è¯•

```bash
cd /path/to/issue-tracker-cli
python3 -m unittest discover -s tests -v
```

### 8.3 é›†æˆéªŒè¯

```bash
# 1. è¿ç§»å¯¼å…¥
issue-tracker -p 001 migrate --source all-issues.md --migrator weldsmart

# 2. ç»Ÿè®¡éªŒè¯
issue-tracker -p 001 stats

# 3. æŸ¥è¯¢éªŒè¯
issue-tracker -p 001 query --status pending

# 4. å¯¼å‡ºéªŒè¯
issue-tracker -p 001 export --output /tmp/test-export.md

# 5. sqlite3 ç›´æ¥è®¿é—®
sqlite3 ~/issue-tracker-cli/data/001_*.db "SELECT * FROM v_pending;"
```

---

## 9. æ€§èƒ½è€ƒè™‘

### 9.1 æ•°æ®åº“è§„æ¨¡

- é¢„æœŸè§„æ¨¡: < 10,000 æ¡/é¡¹ç›®
- å•æ¡è®°å½•: ~500 bytes (å«æè¿°æ–‡æœ¬)
- æ•°æ®åº“å¤§å°: < 5 MB

### 9.2 æŸ¥è¯¢ä¼˜åŒ–

- ç´¢å¼•: `priority`, `status`, `discovery_date`, `github_issue_id`
- è§†å›¾: `v_pending` å¸¸ç”¨æŸ¥è¯¢é¢„å®šä¹‰
- glob åŒ¹é…: ä½¿ç”¨ SQL `GLOB` è€Œé Python åè¿‡æ»¤

### 9.3 å®æ—¶æ€§è¦æ±‚

- æ‰€æœ‰æ“ä½œ: < 100ms (åƒæ¡è§„æ¨¡)
- å¯¼å‡ºæ“ä½œ: < 500ms
- ä¸éœ€è¦è¿æ¥æ±  (å•çº¿ç¨‹ CLI)

---

## 10. å®‰å…¨è€ƒè™‘

### 10.1 SQL æ³¨å…¥é˜²æŠ¤

- ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ (`?` å ä½ç¬¦)
- ä¸æ‹¼æ¥ SQL å­—ç¬¦ä¸²

### 10.2 æ–‡ä»¶æ“ä½œ

- æ•°æ®åº“å†™å…¥å‰æ ¡éªŒè·¯å¾„
- å¯¼å‡ºæ–‡ä»¶è·¯å¾„å¯é…ç½®

### 10.3 GitHub åŒæ­¥

- ä»… `close` æ“ä½œï¼Œä¸åˆ›å»º/ä¿®æ”¹ Issue
- å¤±è´¥è®°å½•æ—¥å¿—ï¼Œä¸é‡è¯•é¿å…è¯¯æ“ä½œ

---

## 11. æ‰©å±•ç‚¹

### 11.1 æ–°å¢ Migrator

```python
# migrators/custom_migrator.py
from . import BaseMigrator

class CustomMigrator(BaseMigrator):
    def parse(self, source_path: str) -> list[dict]:
        # å®ç°é¡¹ç›®ç‰¹å®šè§£æé€»è¾‘
        ...
```

### 11.2 è‡ªå®šä¹‰å¯¼å‡ºæ ¼å¼

ç»§æ‰¿ `Exporter` å¹¶è¦†ç›– `export()` æ–¹æ³•ã€‚

### 11.3 æ–°å¢å‘½ä»¤

åœ¨ `cli.py` ä¸­æ·»åŠ æ–°çš„å‘½ä»¤å¤„ç†å‡½æ•°å’Œ `argparse` å­è§£æå™¨ã€‚

---

## 12. ä¾èµ–æ¸…å•

### 12.1 Python ä¾èµ–

```
PyYAML>=6.0
```

### 12.2 å¤–éƒ¨å·¥å…·ä¾èµ–

```
gh (GitHub CLI) - ç”¨äº GitHub åŒæ­¥åŠŸèƒ½
sqlite3 (å¯é€‰) - ç”¨äºç›´æ¥å‘½ä»¤è¡Œè®¿é—®æ•°æ®åº“
```

### 12.3 Python ç‰ˆæœ¬

- **æœ€ä½**: Python 3.10
- **æ¨è**: Python 3.11+

---

## 13. ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ |
|---------|------|--------|
| `ISSUE_TRACKER_HOME` | ä¸»ç›®å½•è·¯å¾„ | `~/issue-tracker-cli` |

---

## 14. é™„å½•

### 14.1 æ–‡ä»¶æ¸…å•

```
src/issue_tracker/
â”œâ”€â”€ cli.py                  # CLI å…¥å£
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database.py         # æ•°æ®è®¿é—®
â”‚   â”œâ”€â”€ model.py            # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ exporter.py         # å¯¼å‡ºå™¨
â”‚   â””â”€â”€ github_sync.py      # GitHub åŒæ­¥
â”œâ”€â”€ migrators/
â”‚   â”œâ”€â”€ __init__.py         # åŸºç±»
â”‚   â””â”€â”€ weldsmart_migrator.py  # WeldSmart è§£æå™¨
â””â”€â”€ tests/
    â””â”€â”€ test_issue_manager.py  # å•å…ƒæµ‹è¯•
```

### 14.2 ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´ |
|------|------|------|
| 2.0 | 2026-02-04 | å¤šé¡¹ç›®æ”¯æŒï¼Œå…¨å±€è‡ªåŠ¨é€’å¢ç¼–å· |
| 1.0 | 2026-02-03 | åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒ WeldSmart Pro |

---

**æ–‡æ¡£ç»“æŸ**
